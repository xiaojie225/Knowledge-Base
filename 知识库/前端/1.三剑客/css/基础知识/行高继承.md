# 📚 CSS `line-height` 继承机制 完整笔记

## 1️⃣ 核心概念速览

**什么是 `line-height`?**
`line-height` 定义了文本行与行之间的垂直距离(从一行基线到下一行基线的距离),直接影响文本的可读性和视觉节奏。

**使用场景:**
- 全局排版系统设计
- 组件化开发中的文本样式
- 响应式设计中的自适应排版

**核心陷阱:**
⚠️ 百分比/em单位的 `line-height` 会继承**计算后的固定值**,而非比例本身!

---

## 2️⃣ 工作原理深度解析

### 继承机制的三种模式

| 值类型 | 父元素如何计算 | 子元素继承什么 | 子元素最终行高 |
|--------|---------------|---------------|---------------|
| **百分比** (`200%`) | 父字体 × 200% = 固定值 | ✗ 继承计算后的固定像素值 | 与自身字体大小无关 |
| **无单位数值** (`2`) | 父字体 × 2 = 供参考 | ✓ 继承比例因子 | 子字体 × 2 = 动态计算 |
| **固定单位** (`40px`) | 直接使用固定值 | ✗ 继承固定像素值 | 固定值,不随字体变化 |

### 问题示例剖析

```css
/* ❌ 问题代码 */
body {
    font-size: 20px;
    line-height: 200%;  /* 计算: 20px × 200% = 40px */
}

p {
    font-size: 16px;    /* 继承了父级的 40px 行高! */
    /* 实际效果: 16px字体配40px行高 → 行距过大 */
}
```

**为什么会这样?**
浏览器执行流程:
1. 计算 `body` 的 `line-height`: `20px × 200% = 40px`
2. 将计算结果 `40px` 存储为继承值
3. `p` 元素直接继承 `40px`,完全忽略自己的 `font-size: 16px`

---

## 3️⃣ 实践应用代码示例

### ✅ 推荐方案: 无单位数值

```css
/* 最佳实践 */
html {
    font-size: 16px;
    line-height: 1.6;  /* 比例因子,适用于所有后代 */
}

h1 {
    font-size: 32px; 
    /* 自动计算: 32px × 1.6 = 51.2px 行高 */
}

p {
    font-size: 16px; 
    /* 自动计算: 16px × 1.6 = 25.6px 行高 */
}

small {
    font-size: 12px; 
    /* 自动计算: 12px × 1.6 = 19.2px 行高 */
}
```

### ⚠️ 对比: 百分比的问题

```css
/* 问题方案 */
.container {
    font-size: 20px;
    line-height: 150%;  /* = 30px */
}

.card-title {
    font-size: 24px;  
    /* 继承30px → 24px字体配30px行高,过于紧凑! */
}

.card-text {
    font-size: 14px;  
    /* 继承30px → 14px字体配30px行高,过于松散! */
}
```

### 🔧 实战场景: Typography 系统

```css
/* 设计系统中的排版变量 */
:root {
    --line-height-tight: 1.25;   /* 标题用 */
    --line-height-normal: 1.6;   /* 正文用 */
    --line-height-loose: 2;      /* 特殊场景 */
}

.heading {
    line-height: var(--line-height-tight);
}

.body-text {
    line-height: var(--line-height-normal);
}

.code-block {
    line-height: var(--line-height-loose);
}
```

---

## 4️⃣ 最佳实践清单

✅ **DO - 推荐做法**
- 在根元素(`html`)设置无单位的全局 `line-height` (如 `1.5` 或 `1.6`)
- 对特殊元素(如代码块)可以覆盖为特定的无单位值
- 使用 CSS 变量管理不同类型内容的行高比例

✅ **特殊场景例外**
- 对于图标字体或单行文本垂直居中,可以使用固定 `px` 值
- 在精确的像素级设计中(如邮件模板),可能需要固定值

⚠️ **DON'T - 避免的做法**
- ❌ 不要在父元素使用百分比或 `em` 单位的 `line-height`
- ❌ 不要依赖 `normal` 值(不同浏览器/字体差异大)
- ❌ 不要在组件级别过度覆盖全局行高(破坏排版一致性)

---

## 5️⃣ 进阶拓展

### 与其他属性的关联

**计算行距(leading)**
```
行距 = line-height - font-size
上下各分配一半: (line-height - font-size) / 2
```

示例:
- `font-size: 16px`, `line-height: 24px`
- 行距 = `24px - 16px = 8px`
- 文本上下各有 `4px` 间距

### 垂直居中技巧

```css
/* 单行文本垂直居中 */
.button {
    height: 40px;
    line-height: 40px;  /* 这里可以用固定值 */
    /* 文本会自动垂直居中 */
}
```

### 与 `font-size` 相关的其他属性

同样基于 `font-size` 计算的 CSS 属性:
- `em` 单位的任何属性
- `text-indent` 的百分比值
- `vertical-align` 的百分比值

---

# 🎯 CSS `line-height` 继承 面试速记

## ⚡ 30秒电梯演讲

`line-height` 控制行间距。**关键陷阱**:百分比/em单位会让子元素继承父元素计算后的**固定像素值**,而非比例,导致排版失控。**最佳实践**:始终使用无单位数值(如`1.6`),子元素会继承比例因子并根据自身字体动态计算,实现响应式排版。

---

## 🔥 高频考点(必背)

**Q1: 继承的是什么?**
- 百分比/em → 继承计算后的**固定px值**
- 无单位数值 → 继承**比例因子**本身

**Q2: 为什么推荐无单位值?**
因为子元素会用比例乘以**自己的字体大小**重新计算,保持排版和谐,适应响应式设计。

**Q3: 默认值是什么?**
`normal`,通常约等于 `1.2`,但依赖浏览器和字体,不可靠。

**Q4: 行距如何计算?**
`行距 = line-height - font-size`,平均分配到文本上下。

**Q5: `200%` 和 `2` 的区别?**
- `200%`: 父元素算完传固定值给子元素
- `2`: 传比例因子,子元素自己算

---

## 💻 经典代码题

### 题目1: 计算最终行高

```css
body {
    font-size: 20px;
    line-height: 150%;
}

p {
    font-size: 16px;
}
```

**问: `<p>` 的最终 `line-height` 是多少?**

**思路:**
1. 计算父元素: `20px × 150% = 30px`
2. 子元素继承: `30px` (固定值)
3. 答案: **30px** (与自己的16px无关!)

---

### 题目2: 修复继承问题

```css
/* 问题代码 */
.container {
    font-size: 24px;
    line-height: 200%; /* 48px */
}

.text {
    font-size: 14px; 
    /* 继承48px,太松散! */
}
```

**如何修复让排版协调?**

**代码框架:**
```css
/* 解决方案 */
.container {
    font-size: 24px;
    line-height: 2;     /* 改为无单位 */
}

.text {
    font-size: 14px; 
    /* 现在是: 14px × 2 = 28px,完美! */
}
```

---

### 题目3: 多层嵌套继承

```html
<div class="outer">        <!-- 20px, line-height: 2 -->
    <div class="middle">   <!-- 16px -->
        <p class="inner">  <!-- 12px -->
            文本
        </p>
    </div>
</div>
```

**问: `<p>` 的 `line-height` 是多少?**

**答案:** `24px`
**推导:**
- `outer` 传递比例因子 `2`
- `middle` 继承比例 `2`,算出自己的: `16px × 2 = 32px`(但仍传递比例因子)
- `inner` 继承比例 `2`,算自己的: `12px × 2 = 24px` ✓

---

## 🆚 对比题(易混淆)

| 对比项 | `line-height: 200%` | `line-height: 2` |
|--------|---------------------|------------------|
| **继承内容** | 父元素计算出的固定px值 | 比例因子(数字2) |
| **子元素表现** | 行高固定,不随自身字体变化 | 行高=自身字体×2,动态 |
| **适用场景** | 几乎不推荐使用 | 全局排版首选 |
| **响应式友好** | ❌ 不友好 | ✅ 完美支持 |

| 对比项 | `line-height: 30px` | `line-height: 1.5em` |
|--------|---------------------|---------------------|
| **计算方式** | 固定值 | 父元素字体×1.5em |
| **继承** | 继承30px固定值 | 继承计算后的固定值 |
| **相同点** | 都是传递固定值给子元素 | 都不随子元素字体变化 |

---

## 📊 难度评级

**理解难度:** ⭐⭐⭐☆☆
(概念简单,但继承机制的细节容易混淆)

**面试频率:** ⭐⭐⭐⭐⭐
(CSS基础高频考点,尤其是百分比继承陷阱)

**建议复习时间:** 1-2小时
- 30分钟理解原理
- 30分钟练习代码计算
- 30分钟记忆最佳实践

---

## ⚠️ 补充要点(自查清单)

### 易错点强化

✓ **陷阱1:** "父元素设置 `line-height: 150%`,子元素字体更小,为啥行距还那么大?"
  → 因为子元素继承的是父元素基于**父字体**算出的固定值!

✓ **陷阱2:** "为什么说 `em` 和百分比一样有问题?"
  → `1.5em` 也是先基于当前元素字体计算成固定值,再传给子元素,本质相同!

✓ **陷阱3:** "`line-height: normal` 可以用吗?"
  → 不推荐!不同浏览器和字体渲染结果不一致,无法精确控制。

### 实战记忆口诀

> **"百分em传固定,无单位传比例;
> 全局设根html,组件继承真和谐"**

### 快速判断法则

看到 `line-height`,问自己:
1. 有单位(%, em, px)? → 子元素会拿到固定值 → ❌ 不灵活
2. 无单位数字? → 子元素拿到比例自己算 → ✅ 推荐

---

**📌 学习建议:**
1. 先理解"继承的是计算值还是比例"这个核心差异
2. 手动计算3-5个不同场景的行高值加深印象
3. 在实际项目中统一使用无单位 `line-height`,观察效果
4. 面试前重点复习"对比题"和"经典代码题"部分