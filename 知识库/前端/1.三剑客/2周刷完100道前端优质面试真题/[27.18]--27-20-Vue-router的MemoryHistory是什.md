# Vue Router 的 MemoryHistory 模式详解

## 目录

- [什么是 MemoryHistory](#什么是-memoryhistory)
- [Vue Router 的三种模式对比](#vue-router-的三种模式对比)
- [MemoryHistory 的实际表现](#memoryhistory-的实际表现)
- [React Router 中的对应模式](#react-router-中的对应模式)
- [AI 总结](#ai-总结)

## 什么是 MemoryHistory

MemoryHistory 是 Vue Router 最新版本（Vue 3.0 的 Vue Router）中的一种路由模式。在 Vue Router 2 中，这个模式被称为 **abstract 模式**，现在改名为 MemoryHistory，这个名字更加直观，因为它表示路由信息存储在内存中。

**命名演变**：
- Vue Router 2：abstract 模式
- Vue Router 4（面向 Vue 3）：MemoryHistory

abstract 这个词本身就很抽象，在路由中使用会让概念更加难以理解，而 MemoryHistory（内存历史）这个名字更容易理解其工作原理。

## Vue Router 的三种模式对比

Vue Router 提供三种路由模式，每种模式的实现原理和表现都不同：

### 1\. WebHistory 模式（HTML5 History）

**实现原理**：
- 使用 HTML5 的 History API
- 通过 `history.pushState()` 推送路由
- 通过 `window.onpopstate` 监听路由变化

**路由表现**：
```
http://localhost:8080/
http://localhost:8080/about
```

路由变化时 URL 会正常改变，类似传统的 URL 路径，没有特殊符号。

### 2\. HashHistory 模式（Hash）

**实现原理**：
- 使用 `location.hash` 技术
- 通过监听 hash 变化实现路由切换

**路由表现**：
```
http://localhost:8080/#/
http://localhost:8080/#/about
```

URL 中包含 `#` 符号，路由信息在 `#` 后面。

### 3\. MemoryHistory 模式（之前的 Abstract）

**实现原理**：
- 路由信息存储在内存中
- 不依赖浏览器的 URL
- 不会产生浏览器历史记录

**路由表现**：
```
http://localhost:8080/
```

无论如何切换路由，URL 始终保持不变。

## MemoryHistory 的实际表现

### 代码配置

在 Vue CLI 创建的项目中，默认使用 WebHistory 模式。要切换到 MemoryHistory，需要修改路由配置：

```javascript
// 从
createWebHistory()

// 改为
createMemoryHistory()
```

### 实际效果演示

**访问 `localhost:8080` 时**：
- 点击 About 链接
- URL 不会发生任何变化
- 页面内容正常切换显示
- 浏览器的前进/后退按钮不可用

**后退行为**：
- 点击浏览器后退按钮
- 会直接退出到之前访问的页面（如搜索引擎）
- 不会在应用内部的路由间后退

### 使用场景

MemoryHistory 模式的特点：
- 把整个应用当作一个独立的组件
- 路由切换只是内部组件的切换
- 不会改变浏览器 URL
- 不会产生浏览器历史记录
- 不支持前进/后退功能

这种模式适合：
- 嵌入式应用
- 不需要 URL 变化的场景
- 需要完全控制路由行为的情况

## React Router 中的对应模式

React Router 同样提供这三种路由模式，表现完全一致：

1. **BrowserRouter** - 对应 WebHistory
2. **HashRouter** - 对应 HashHistory  
3. **MemoryRouter** - 对应 MemoryHistory

只需要改变 Router 组件的类型，就可以切换不同的路由模式，三种模式的表现与 Vue Router 完全相同。

## AI 总结

MemoryHistory（原 abstract 模式）是 Vue Router 的第三种路由模式，与常用的 WebHistory 和 HashHistory 不同，它将路由信息存储在内存中，不会改变浏览器 URL，也不会产生浏览器历史记录。这种模式适合将整个应用作为独立组件使用的场景，路由切换仅在应用内部进行，不影响浏览器的导航行为。React Router 也提供相同的三种模式，使用方式和表现完全一致。