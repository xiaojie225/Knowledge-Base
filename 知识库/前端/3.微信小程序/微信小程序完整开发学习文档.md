# å¾®ä¿¡å°ç¨‹åºå®Œæ•´å¼€å‘å­¦ä¹ æ–‡æ¡£

> æœ¬æ–‡æ¡£å‚è€ƒå¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£,åŒ…å«å®Œæ•´çš„ç»„ä»¶ã€API ä½¿ç”¨è¯´æ˜ã€ä»£ç ç¤ºä¾‹ä»¥åŠé¢è¯•é¢˜

## ğŸ“š ç›®å½•

1. [æ¡†æ¶åŸºç¡€](#æ¡†æ¶åŸºç¡€)
2. [ç»„ä»¶ç³»ç»Ÿ](#ç»„ä»¶ç³»ç»Ÿ)
3. [API ç³»ç»Ÿ](#apiç³»ç»Ÿ)
4. [é¢è¯•é¢˜æ±‡æ€»](#é¢è¯•é¢˜æ±‡æ€»)

---

## æ¡†æ¶åŸºç¡€

### 1. é¡¹ç›®ç»“æ„

å°ç¨‹åºåŒ…å«ä¸€ä¸ªæè¿°æ•´ä½“ç¨‹åºçš„ app å’Œå¤šä¸ªæè¿°å„è‡ªé¡µé¢çš„ pageã€‚

```
miniprogram/
â”œâ”€â”€ app.js          // å°ç¨‹åºé€»è¾‘
â”œâ”€â”€ app.json        // å°ç¨‹åºå…¨å±€é…ç½®
â”œâ”€â”€ app.wxss        // å°ç¨‹åºå…¨å±€æ ·å¼
â”œâ”€â”€ sitemap.json    // æœç´¢é…ç½®
â””â”€â”€ pages/          // é¡µé¢æ–‡ä»¶å¤¹
    â”œâ”€â”€ index/
    â”‚   â”œâ”€â”€ index.js    // é¡µé¢é€»è¾‘
    â”‚   â”œâ”€â”€ index.json  // é¡µé¢é…ç½®
    â”‚   â”œâ”€â”€ index.wxml  // é¡µé¢ç»“æ„
    â”‚   â””â”€â”€ index.wxss  // é¡µé¢æ ·å¼
    â””â”€â”€ logs/
```

**ä¾‹å­ï¼šapp.json é…ç½®**
```json
{
  "pages": [
    "pages/index/index",
    "pages/user/user"
  ],
  "window": {
    "navigationBarTitleText": "æˆ‘çš„å°ç¨‹åº",
    "navigationBarBackgroundColor": "#ffffff",
    "backgroundColor": "#f8f8f8",
    "enablePullDownRefresh": false
  },
  "tabBar": {
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "é¦–é¡µ",
        "iconPath": "images/home.png",
        "selectedIconPath": "images/home-active.png"
      }
    ]
  }
}
```

### 2. ç”Ÿå‘½å‘¨æœŸ

**åº”ç”¨ç”Ÿå‘½å‘¨æœŸ**
```javascript
// app.js
App({
  onLaunch(options) {
    // å°ç¨‹åºåˆå§‹åŒ–å®Œæˆæ—¶è§¦å‘ï¼Œå…¨å±€åªè§¦å‘ä¸€æ¬¡
    console.log('å°ç¨‹åºå¯åŠ¨', options)
  },
  onShow(options) {
    // å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–ä»åå°è¿›å…¥å‰å°æ˜¾ç¤ºæ—¶è§¦å‘
  },
  onHide() {
    // å°ç¨‹åºä»å‰å°è¿›å…¥åå°æ—¶è§¦å‘
  },
  globalData: {
    userInfo: null
  }
})
```

**é¡µé¢ç”Ÿå‘½å‘¨æœŸ**
```javascript
Page({
  data: {
    list: []
  },
  onLoad(options) {
    // é¡µé¢åŠ è½½æ—¶è§¦å‘ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡
    console.log('é¡µé¢å‚æ•°', options)
  },
  onShow() {
    // é¡µé¢æ˜¾ç¤º/åˆ‡å…¥å‰å°æ—¶è§¦å‘
  },
  onReady() {
    // é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆæ—¶è§¦å‘ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡
  },
  onHide() {
    // é¡µé¢éšè—/åˆ‡å…¥åå°æ—¶è§¦å‘
  },
  onUnload() {
    // é¡µé¢å¸è½½æ—¶è§¦å‘
  },
  onPullDownRefresh() {
    // ç”¨æˆ·ä¸‹æ‹‰åˆ·æ–°æ—¶è§¦å‘
  },
  onReachBottom() {
    // é¡µé¢ä¸Šæ‹‰è§¦åº•æ—¶è§¦å‘
  },
  onShareAppMessage() {
    // ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«æ—¶è§¦å‘
    return {
      title: 'åˆ†äº«æ ‡é¢˜',
      path: '/pages/index/index'
    }
  }
})
```

### 3. æ•°æ®ç»‘å®š

```xml
<!-- æ–‡æœ¬ç»‘å®š -->
<view>{{message}}</view>

<!-- å±æ€§ç»‘å®š -->
<view id="item-{{id}}">{{text}}</view>

<!-- æ¡ä»¶æ¸²æŸ“ -->
<view wx:if="{{condition}}">æ˜¾ç¤ºå†…å®¹</view>

<!-- åˆ—è¡¨æ¸²æŸ“ -->
<view wx:for="{{array}}" wx:key="id">
  {{index}}: {{item.name}}
</view>

<!-- è¿ç®— -->
<view>{{a + b}}</view>
<view>{{flag ? 'true' : 'false'}}</view>
```

---

## ç»„ä»¶ç³»ç»Ÿ

### è§†å›¾å®¹å™¨

#### 1. viewï¼ˆè§†å›¾å®¹å™¨ï¼‰

æœ€å¸¸ç”¨çš„å®¹å™¨ç»„ä»¶ï¼Œç±»ä¼¼ HTML çš„ divã€‚

```xml
<view class="container">
  <view class="box" hover-class="box-hover">
    ç‚¹å‡»æˆ‘
  </view>
</view>
```

#### 2. scroll-viewï¼ˆå¯æ»šåŠ¨è§†å›¾ï¼‰

```xml
<!-- çºµå‘æ»šåŠ¨ -->
<scroll-view scroll-y style="height: 200px" bindscrolltolower="loadMore">
  <view wx:for="{{list}}" wx:key="id">{{item.name}}</view>
</scroll-view>

<!-- æ¨ªå‘æ»šåŠ¨ -->
<scroll-view scroll-x class="scroll-x">
  <view wx:for="{{tabs}}" wx:key="id" class="tab-item">
    {{item.name}}
  </view>
</scroll-view>
```

```javascript
Page({
  data: {
    list: [],
    tabs: [{id: 1, name: 'æ ‡ç­¾1'}]
  },
  loadMore() {
    // åŠ è½½æ›´å¤šæ•°æ®
    console.log('è§¦åº•åŠ è½½')
  }
})
```

#### 3. swiperï¼ˆè½®æ’­å›¾ï¼‰

```xml
<swiper 
  indicator-dots 
  autoplay 
  interval="3000" 
  circular
  bindchange="onSwiperChange">
  <swiper-item wx:for="{{banners}}" wx:key="id">
    <image src="{{item.url}}" mode="aspectFill" />
  </swiper-item>
</swiper>
```

```javascript
Page({
  data: {
    banners: [
      {id: 1, url: '/images/banner1.jpg'},
      {id: 2, url: '/images/banner2.jpg'}
    ]
  },
  onSwiperChange(e) {
    console.log('å½“å‰ç´¢å¼•', e.detail.current)
  }
})
```

### åŸºç¡€å†…å®¹

#### 1. textï¼ˆæ–‡æœ¬ï¼‰

```xml
<text selectable>å¯é€‰æ‹©çš„æ–‡æœ¬</text>
<text decode>&lt;div&gt;</text>
```

#### 2. rich-textï¼ˆå¯Œæ–‡æœ¬ï¼‰

```xml
<rich-text nodes="{{html}}"></rich-text>
```

```javascript
Page({
  data: {
    html: '<div style="color: red;">å¯Œæ–‡æœ¬å†…å®¹</div>'
  }
})
```

#### 3. progressï¼ˆè¿›åº¦æ¡ï¼‰

```xml
<progress percent="{{progress}}" show-info active />
<button bindtap="startProgress">å¼€å§‹</button>
```

```javascript
Page({
  data: {
    progress: 0
  },
  startProgress() {
    let progress = 0
    const timer = setInterval(() => {
      progress += 10
      this.setData({ progress })
      if (progress >= 100) clearInterval(timer)
    }, 100)
  }
})
```

### è¡¨å•ç»„ä»¶

#### 1. buttonï¼ˆæŒ‰é’®ï¼‰

```xml
<button type="primary">ä¸»è¦æŒ‰é’®</button>
<button type="warn" size="mini">è­¦å‘ŠæŒ‰é’®</button>
<button plain>é•‚ç©ºæŒ‰é’®</button>
<button loading>åŠ è½½ä¸­</button>

<!-- å¼€æ”¾èƒ½åŠ› -->
<button open-type="getUserInfo" bindgetuserinfo="getUserInfo">
  è·å–ç”¨æˆ·ä¿¡æ¯
</button>
<button open-type="getPhoneNumber" bindgetphonenumber="getPhoneNumber">
  è·å–æ‰‹æœºå·
</button>
<button open-type="contact">è”ç³»å®¢æœ</button>
<button open-type="share">åˆ†äº«</button>
```

```javascript
Page({
  getUserInfo(e) {
    console.log('ç”¨æˆ·ä¿¡æ¯', e.detail.userInfo)
  },
  getPhoneNumber(e) {
    // éœ€è¦å‘é€ e.detail.code åˆ°åç«¯æ¢å–æ‰‹æœºå·
    console.log('code', e.detail.code)
  }
})
```

#### 2. inputï¼ˆè¾“å…¥æ¡†ï¼‰

```xml
<input 
  value="{{username}}" 
  placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
  maxlength="20"
  bindinput="onInput"
  bindconfirm="onConfirm"
/>

<input type="number" placeholder="æ‰‹æœºå·" maxlength="11" />
<input type="text" password placeholder="å¯†ç " />
```

```javascript
Page({
  data: {
    username: ''
  },
  onInput(e) {
    this.setData({
      username: e.detail.value
    })
  },
  onConfirm(e) {
    console.log('ç¡®è®¤è¾“å…¥', e.detail.value)
  }
})
```

#### 3. checkboxï¼ˆå¤šé€‰æ¡†ï¼‰

```xml
<checkbox-group bindchange="checkboxChange">
  <label wx:for="{{items}}" wx:key="value">
    <checkbox value="{{item.value}}" checked="{{item.checked}}" />
    {{item.name}}
  </label>
</checkbox-group>
```

```javascript
Page({
  data: {
    items: [
      {name: 'é€‰é¡¹1', value: 'opt1', checked: false},
      {name: 'é€‰é¡¹2', value: 'opt2', checked: true}
    ]
  },
  checkboxChange(e) {
    console.log('é€‰ä¸­çš„å€¼', e.detail.value)
  }
})
```

#### 4. radioï¼ˆå•é€‰æ¡†ï¼‰

```xml
<radio-group bindchange="radioChange">
  <label wx:for="{{items}}" wx:key="value">
    <radio value="{{item.value}}" checked="{{item.checked}}" />
    {{item.name}}
  </label>
</radio-group>
```

#### 5. pickerï¼ˆé€‰æ‹©å™¨ï¼‰

```xml
<!-- æ™®é€šé€‰æ‹©å™¨ -->
<picker mode="selector" range="{{cities}}" bindchange="bindPickerChange">
  <view>å½“å‰é€‰æ‹©ï¼š{{cities[index]}}</view>
</picker>

<!-- æ—¶é—´é€‰æ‹©å™¨ -->
<picker mode="time" value="{{time}}" bindchange="timeChange">
  <view>æ—¶é—´ï¼š{{time}}</view>
</picker>

<!-- æ—¥æœŸé€‰æ‹©å™¨ -->
<picker mode="date" value="{{date}}" bindchange="dateChange">
  <view>æ—¥æœŸï¼š{{date}}</view>
</picker>

<!-- çœå¸‚åŒºé€‰æ‹©å™¨ -->
<picker mode="region" bindchange="regionChange">
  <view>åœ°åŒºï¼š{{region[0]}} {{region[1]}} {{region[2]}}</view>
</picker>
```

```javascript
Page({
  data: {
    cities: ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·'],
    index: 0,
    time: '12:00',
    date: '2024-01-01',
    region: ['å¹¿ä¸œçœ', 'å¹¿å·å¸‚', 'å¤©æ²³åŒº']
  },
  bindPickerChange(e) {
    this.setData({ index: e.detail.value })
  },
  timeChange(e) {
    this.setData({ time: e.detail.value })
  },
  dateChange(e) {
    this.setData({ date: e.detail.value })
  },
  regionChange(e) {
    this.setData({ region: e.detail.value })
  }
})
```

#### 6. sliderï¼ˆæ»‘åŠ¨é€‰æ‹©å™¨ï¼‰

```xml
<slider 
  value="{{volume}}" 
  min="0" 
  max="100" 
  show-value 
  bindchange="sliderChange"
/>
```

#### 7. switchï¼ˆå¼€å…³ï¼‰

```xml
<switch checked="{{checked}}" bindchange="switchChange" />
```

### å¯¼èˆªç»„ä»¶

#### navigatorï¼ˆé¡µé¢é“¾æ¥ï¼‰

```xml
<!-- ä¿ç•™å½“å‰é¡µ -->
<navigator url="/pages/detail/detail?id=1">è·³è½¬è¯¦æƒ…</navigator>

<!-- å…³é—­å½“å‰é¡µ -->
<navigator url="/pages/detail/detail" open-type="redirect">
  é‡å®šå‘
</navigator>

<!-- è·³è½¬ tabBar -->
<navigator url="/pages/index/index" open-type="switchTab">
  å›é¦–é¡µ
</navigator>

<!-- è¿”å›ä¸Šä¸€é¡µ -->
<navigator open-type="navigateBack">è¿”å›</navigator>
```

### åª’ä½“ç»„ä»¶

#### 1. imageï¼ˆå›¾ç‰‡ï¼‰

```xml
<image 
  src="{{imageUrl}}" 
  mode="aspectFill"
  lazy-load
  bindload="imageLoad"
  binderror="imageError"
  bindtap="previewImage"
/>
```

```javascript
Page({
  data: {
    imageUrl: 'https://example.com/img.jpg'
  },
  imageLoad(e) {
    console.log('å›¾ç‰‡åŠ è½½æˆåŠŸ', e.detail)
  },
  imageError(e) {
    console.log('å›¾ç‰‡åŠ è½½å¤±è´¥')
  },
  previewImage() {
    wx.previewImage({
      current: this.data.imageUrl,
      urls: [this.data.imageUrl]
    })
  }
})
```

#### 2. videoï¼ˆè§†é¢‘ï¼‰

```xml
<video 
  src="{{videoUrl}}"
  poster="{{poster}}"
  controls
  bindplay="onPlay"
  bindpause="onPause"
  bindended="onEnded"
/>
```

---

## APIç³»ç»Ÿ

### ç½‘ç»œè¯·æ±‚

#### wx.requestï¼ˆå‘èµ· HTTP è¯·æ±‚ï¼‰

```javascript
// GET è¯·æ±‚
wx.request({
  url: 'https://api.example.com/data',
  method: 'GET',
  data: {
    id: 1
  },
  header: {
    'content-type': 'application/json'
  },
  success(res) {
    console.log('è¯·æ±‚æˆåŠŸ', res.data)
  },
  fail(err) {
    console.log('è¯·æ±‚å¤±è´¥', err)
  }
})

// POST è¯·æ±‚
wx.request({
  url: 'https://api.example.com/submit',
  method: 'POST',
  data: {
    name: 'test',
    age: 20
  },
  success(res) {
    console.log(res.data)
  }
})
```

#### wx.uploadFileï¼ˆä¸Šä¼ æ–‡ä»¶ï¼‰

```javascript
wx.chooseImage({
  count: 1,
  success(res) {
    const tempFilePath = res.tempFilePaths[0]
    wx.uploadFile({
      url: 'https://api.example.com/upload',
      filePath: tempFilePath,
      name: 'file',
      formData: {
        user: 'test'
      },
      success(res) {
        console.log('ä¸Šä¼ æˆåŠŸ', res.data)
      }
    })
  }
})
```

#### wx.downloadFileï¼ˆä¸‹è½½æ–‡ä»¶ï¼‰

```javascript
wx.downloadFile({
  url: 'https://example.com/file.pdf',
  success(res) {
    if (res.statusCode === 200) {
      console.log('ä¸‹è½½æˆåŠŸ', res.tempFilePath)
    }
  }
})
```

### æ•°æ®ç¼“å­˜

#### åŒæ­¥å­˜å‚¨
```javascript
// å­˜å‚¨
wx.setStorageSync('key', 'value')
wx.setStorageSync('user', { name: 'test', age: 20 })

// è¯»å–
const value = wx.getStorageSync('key')
const user = wx.getStorageSync('user')

// åˆ é™¤
wx.removeStorageSync('key')

// æ¸…ç©º
wx.clearStorageSync()
```

#### å¼‚æ­¥å­˜å‚¨
```javascript
// å­˜å‚¨
wx.setStorage({
  key: 'key',
  data: 'value',
  success() {
    console.log('å­˜å‚¨æˆåŠŸ')
  }
})

// è¯»å–
wx.getStorage({
  key: 'key',
  success(res) {
    console.log(res.data)
  }
})

// åˆ é™¤
wx.removeStorage({
  key: 'key'
})

// æ¸…ç©º
wx.clearStorage()
```

### ç•Œé¢äº¤äº’

#### wx.showToastï¼ˆæ¶ˆæ¯æç¤ºï¼‰

```javascript
wx.showToast({
  title: 'æˆåŠŸ',
  icon: 'success',
  duration: 2000
})

wx.showToast({
  title: 'åŠ è½½ä¸­',
  icon: 'loading'
})

wx.showToast({
  title: 'æç¤ºä¿¡æ¯',
  icon: 'none'
})
```

#### wx.showModalï¼ˆæ¨¡æ€å¯¹è¯æ¡†ï¼‰

```javascript
wx.showModal({
  title: 'æç¤º',
  content: 'ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ',
  success(res) {
    if (res.confirm) {
      console.log('ç”¨æˆ·ç‚¹å‡»ç¡®å®š')
    } else if (res.cancel) {
      console.log('ç”¨æˆ·ç‚¹å‡»å–æ¶ˆ')
    }
  }
})
```

#### wx.showLoadingï¼ˆåŠ è½½æç¤ºï¼‰

```javascript
wx.showLoading({
  title: 'åŠ è½½ä¸­...',
  mask: true
})

setTimeout(() => {
  wx.hideLoading()
}, 2000)
```

#### wx.showActionSheetï¼ˆæ“ä½œèœå•ï¼‰

```javascript
wx.showActionSheet({
  itemList: ['é€‰é¡¹ä¸€', 'é€‰é¡¹äºŒ', 'é€‰é¡¹ä¸‰'],
  success(res) {
    console.log('é€‰æ‹©äº†ç¬¬' + (res.tapIndex + 1) + 'ä¸ª')
  }
})
```

### è·¯ç”±è·³è½¬

```javascript
// ä¿ç•™å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢
wx.navigateTo({
  url: '/pages/detail/detail?id=1'
})

// å…³é—­å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢
wx.redirectTo({
  url: '/pages/detail/detail'
})

// è·³è½¬åˆ° tabBar é¡µé¢
wx.switchTab({
  url: '/pages/index/index'
})

// å…³é—­æ‰€æœ‰é¡µé¢ï¼Œæ‰“å¼€åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢
wx.reLaunch({
  url: '/pages/index/index'
})

// è¿”å›ä¸Šä¸€é¡µæˆ–å¤šçº§é¡µé¢
wx.navigateBack({
  delta: 1  // è¿”å›çš„é¡µé¢æ•°
})
```

### ä½ç½®æœåŠ¡

#### wx.getLocationï¼ˆè·å–å½“å‰ä½ç½®ï¼‰

```javascript
wx.getLocation({
  type: 'gcj02',
  success(res) {
    const { latitude, longitude } = res
    console.log('çº¬åº¦', latitude)
    console.log('ç»åº¦', longitude)
  }
})
```

#### wx.chooseLocationï¼ˆæ‰“å¼€åœ°å›¾é€‰æ‹©ä½ç½®ï¼‰

```javascript
wx.chooseLocation({
  success(res) {
    console.log('ä½ç½®åç§°', res.name)
    console.log('è¯¦ç»†åœ°å€', res.address)
    console.log('çº¬åº¦', res.latitude)
    console.log('ç»åº¦', res.longitude)
  }
})
```

### åª’ä½“ç›¸å…³

#### wx.chooseImageï¼ˆé€‰æ‹©å›¾ç‰‡ï¼‰

```javascript
wx.chooseImage({
  count: 9,
  sizeType: ['original', 'compressed'],
  sourceType: ['album', 'camera'],
  success(res) {
    const tempFilePaths = res.tempFilePaths
    console.log('é€‰æ‹©çš„å›¾ç‰‡', tempFilePaths)
  }
})
```

#### wx.previewImageï¼ˆé¢„è§ˆå›¾ç‰‡ï¼‰

```javascript
wx.previewImage({
  current: 'https://example.com/img1.jpg',
  urls: [
    'https://example.com/img1.jpg',
    'https://example.com/img2.jpg'
  ]
})
```

#### wx.getImageInfoï¼ˆè·å–å›¾ç‰‡ä¿¡æ¯ï¼‰

```javascript
wx.getImageInfo({
  src: 'images/a.jpg',
  success(res) {
    console.log('å®½åº¦', res.width)
    console.log('é«˜åº¦', res.height)
  }
})
```

### è®¾å¤‡ä¿¡æ¯

#### wx.getSystemInfoï¼ˆè·å–ç³»ç»Ÿä¿¡æ¯ï¼‰

```javascript
wx.getSystemInfo({
  success(res) {
    console.log('è®¾å¤‡å“ç‰Œ', res.brand)
    console.log('è®¾å¤‡å‹å·', res.model)
    console.log('ç³»ç»Ÿç‰ˆæœ¬', res.system)
    console.log('å±å¹•å®½åº¦', res.windowWidth)
    console.log('å±å¹•é«˜åº¦', res.windowHeight)
    console.log('å¾®ä¿¡ç‰ˆæœ¬', res.version)
    console.log('åŸºç¡€åº“ç‰ˆæœ¬', res.SDKVersion)
  }
})

// åŒæ­¥ç‰ˆæœ¬
const systemInfo = wx.getSystemInfoSync()
```

### å¼€æ”¾æ¥å£

#### wx.loginï¼ˆç™»å½•ï¼‰

```javascript
wx.login({
  success(res) {
    if (res.code) {
      // å‘é€ res.code åˆ°åç«¯æ¢å– openId, sessionKey, unionId
      wx.request({
        url: 'https://api.example.com/login',
        data: {
          code: res.code
        },
        success(response) {
          console.log('ç™»å½•æˆåŠŸ', response.data)
        }
      })
    }
  }
})
```

#### wx.getUserInfoï¼ˆè·å–ç”¨æˆ·ä¿¡æ¯ - å·²åºŸå¼ƒï¼‰

æ–°ç‰ˆæœ¬æ¨èä½¿ç”¨ button ç»„ä»¶çš„ open-type="getUserInfo"

```xml
<button open-type="getUserInfo" bindgetuserinfo="getUserInfo">
  è·å–ç”¨æˆ·ä¿¡æ¯
</button>
```

```javascript
Page({
  getUserInfo(e) {
    console.log(e.detail.userInfo)
  }
})
```

#### wx.getUserProfileï¼ˆè·å–ç”¨æˆ·ä¿¡æ¯ï¼‰

```javascript
wx.getUserProfile({
  desc: 'ç”¨äºå®Œå–„ä¼šå‘˜èµ„æ–™',
  success(res) {
    console.log('ç”¨æˆ·ä¿¡æ¯', res.userInfo)
    // {nickName, avatarUrl, gender, country, province, city}
  }
})
```

#### wx.getAccountInfoSyncï¼ˆè·å–è´¦å·ä¿¡æ¯ï¼‰

```javascript
const accountInfo = wx.getAccountInfoSync()
console.log('å°ç¨‹åº appId', accountInfo.miniProgram.appId)
console.log('å°ç¨‹åºç‰ˆæœ¬', accountInfo.miniProgram.envVersion)
// envVersion: 'develop'(å¼€å‘ç‰ˆ) | 'trial'(ä½“éªŒç‰ˆ) | 'release'(æ­£å¼ç‰ˆ)
```

---

## é¢è¯•é¢˜æ±‡æ€»

### åŸºç¡€æ¦‚å¿µ

**1. å°ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ**

ç­”ï¼š
- åº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼šonLaunchï¼ˆå¯åŠ¨ï¼‰ã€onShowï¼ˆæ˜¾ç¤ºï¼‰ã€onHideï¼ˆéšè—ï¼‰
- é¡µé¢ç”Ÿå‘½å‘¨æœŸï¼šonLoadã€onShowã€onReadyã€onHideã€onUnloadã€onPullDownRefreshã€onReachBottomã€onShareAppMessage

**2. å°ç¨‹åºçš„åŒå‘ç»‘å®šå’Œ Vue æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

ç­”ï¼šå°ç¨‹åºä¸æ”¯æŒåŒå‘ç»‘å®šï¼Œéœ€è¦é€šè¿‡ setData æ–¹æ³•æ‰‹åŠ¨æ›´æ–°æ•°æ®ã€‚Vue æ”¯æŒ v-model åŒå‘ç»‘å®šã€‚

**3. ç®€è¿°å°ç¨‹åºçš„è·¯ç”±æ–¹å¼**

ç­”ï¼š
- wx.navigateToï¼šä¿ç•™å½“å‰é¡µï¼Œè·³è½¬åˆ°æ–°é¡µé¢
- wx.redirectToï¼šå…³é—­å½“å‰é¡µï¼Œè·³è½¬åˆ°æ–°é¡µé¢
- wx.switchTabï¼šè·³è½¬åˆ° tabBar é¡µé¢
- wx.reLaunchï¼šå…³é—­æ‰€æœ‰é¡µé¢ï¼Œè·³è½¬åˆ°æ–°é¡µé¢
- wx.navigateBackï¼šè¿”å›ä¸Šä¸€é¡µ

**4. å°ç¨‹åºçš„ wxss å’Œ css æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

ç­”ï¼š
- wxss æ”¯æŒ rpx å•ä½ï¼ˆå“åº”å¼åƒç´ ï¼‰
- wxss æ”¯æŒ @import å¯¼å…¥æ ·å¼
- wxss ä¸æ”¯æŒæŸäº› CSS3 é€‰æ‹©å™¨
- wxss æœ‰å°ºå¯¸å•ä½æ¢ç®—ï¼ˆ1rpx = 0.5pxï¼‰

**5. å°ç¨‹åºå¦‚ä½•å®ç°ä¸‹æ‹‰åˆ·æ–°ï¼Ÿ**

ç­”ï¼š
```json
// é¡µé¢é…ç½®
{
  "enablePullDownRefresh": true
}
```
```javascript
Page({
  onPullDownRefresh() {
    // å¤„ç†ä¸‹æ‹‰åˆ·æ–°
    wx.stopPullDownRefresh()
  }
})
```

### æ€§èƒ½ä¼˜åŒ–

**6. å°ç¨‹åºæ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿ**

ç­”ï¼š
- å‡å°‘ setData è°ƒç”¨é¢‘ç‡å’Œæ•°æ®é‡
- ä½¿ç”¨åˆ†åŒ…åŠ è½½
- å›¾ç‰‡æ‡’åŠ è½½
- åˆç†ä½¿ç”¨ wx:if å’Œ hidden
- é¿å…åœ¨ onShow ä¸­è°ƒç”¨ setData
- åŠæ—¶æ¸…ç†å®šæ—¶å™¨å’Œäº‹ä»¶ç›‘å¬
- ä½¿ç”¨éª¨æ¶å±æå‡ä½“éªŒ

**7. setData çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ³•ï¼Ÿ**

ç­”ï¼š
- åªæ›´æ–°éœ€è¦æ”¹å˜çš„æ•°æ®
- é¿å…é¢‘ç¹è°ƒç”¨ setData
- æ•°æ®é‡å¤§æ—¶åˆ†æ‰¹æ›´æ–°
- é¿å…è®¾ç½®ä¸åœ¨é¡µé¢æ¸²æŸ“ä¸­ä½¿ç”¨çš„æ•°æ®
```javascript
// ä¸å¥½çš„åšæ³•
this.setData({ list: newList })

// å¥½çš„åšæ³•ï¼ˆåªæ›´æ–°æŸä¸€é¡¹ï¼‰
this.setData({
  [`list[${index}].name`]: 'newName'
})
```

**8. å°ç¨‹åºçš„åˆ†åŒ…åŠ è½½å¦‚ä½•å®ç°ï¼Ÿ**

ç­”ï¼š
```json
{
  "pages": ["pages/index/index"],
  "subpackages": [
    {
      "root": "packageA",
      "pages": ["pages/cat/cat"]
    }
  ]
}
```

### æ•°æ®é€šä¿¡

**9. å°ç¨‹åºé¡µé¢é—´å¦‚ä½•ä¼ é€’æ•°æ®ï¼Ÿ**

ç­”ï¼š
- URL ä¼ å‚ï¼š`/pages/detail?id=1`
- å…¨å±€æ•°æ®ï¼šapp.globalData
- æœ¬åœ°å­˜å‚¨ï¼šwx.setStorageSync/getStorageSync
- äº‹ä»¶æ€»çº¿ï¼šè‡ªå®šä¹‰äº‹ä»¶ç³»ç»Ÿ
- è¿”å›ä¼ å‚ï¼šé€šè¿‡ getCurrentPages() è·å–é¡µé¢æ ˆ

**10. å¦‚ä½•å®ç°çˆ¶å­ç»„ä»¶é€šä¿¡ï¼Ÿ**

ç­”ï¼š
```javascript
// çˆ¶ç»„ä»¶ä¼ å€¼ç»™å­ç»„ä»¶
<custom-component prop-name="{{value}}" />

// å­ç»„ä»¶æ¥æ”¶
Component({
  properties: {
    propName: String
  }
})

// å­ç»„ä»¶ä¼ å€¼ç»™çˆ¶ç»„ä»¶
Component({
  methods: {
    sendData() {
      this.triggerEvent('myevent', { value: 'data' })
    }
  }
})

// çˆ¶ç»„ä»¶æ¥æ”¶
<custom-component bind:myevent="onMyEvent" />
```

### ç™»å½•æˆæƒ

**11. å°ç¨‹åºç™»å½•æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ**

ç­”ï¼š
1. è°ƒç”¨ wx.login() è·å–ä¸´æ—¶ç™»å½•å‡­è¯ code
2. å°† code å‘é€åˆ°å¼€å‘è€…æœåŠ¡å™¨
3. å¼€å‘è€…æœåŠ¡å™¨è°ƒç”¨ auth.code2Session æ¥å£ï¼Œæ¢å– openid å’Œ session_key
4. å¼€å‘è€…æœåŠ¡å™¨ç”Ÿæˆè‡ªå®šä¹‰ç™»å½•æ€ï¼Œè¿”å›ç»™å°ç¨‹åº
5. å°ç¨‹åºå­˜å‚¨ç™»å½•æ€ï¼Œç”¨äºåç»­è¯·æ±‚

```javascript
wx.login({
  success(res) {
    wx.request({
      url: 'https://api.example.com/login',
      data: { code: res.code },
      success(response) {
        wx.setStorageSync('token', response.data.token)
      }
    })
  }
})
```

**12. å¦‚ä½•è·å–ç”¨æˆ·æ‰‹æœºå·ï¼Ÿ**

ç­”ï¼šä½¿ç”¨ button ç»„ä»¶çš„ open-type="getPhoneNumber"
```xml
<button open-type="getPhoneNumber" bindgetphonenumber="getPhoneNumber">
  è·å–æ‰‹æœºå·
</button>
```
```javascript
Page({
  getPhoneNumber(e) {
    if (e.detail.errMsg === 'getPhoneNumber:ok') {
      // å°† e.detail.code å‘é€åˆ°åç«¯è§£å¯†è·å–æ‰‹æœºå·
      wx.request({
        url: 'https://api.example.com/getPhone',
        data: { code: e.detail.code }
      })
    }
  }
})
```

### ç»„ä»¶ç›¸å…³

**13. å°ç¨‹åºè‡ªå®šä¹‰ç»„ä»¶å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ï¼Ÿ**

ç­”ï¼š
```json
// ç»„ä»¶ JSON é…ç½®
{
  "component": true,
  "usingComponents": {}
}
```
```javascript
// ç»„ä»¶ JS
Component({
  properties: {
    title: String
  },
  data: {
    count: 0
  },
  methods: {
    onClick() {
      this.setData({ count: this.data.count + 1 })
      this.triggerEvent('tap', { count: this.data.count })
    }
  }
})
```
```json
// é¡µé¢å¼•ç”¨
{
  "usingComponents": {
    "my-component": "/components/my-component/index"
  }
}
```
```xml
<!-- é¡µé¢ä½¿ç”¨ -->
<my-component title="æ ‡é¢˜" bind:tap="onTap" />
```

**14. wxs æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ**

ç­”ï¼šWXSï¼ˆWeiXin Scriptï¼‰æ˜¯å°ç¨‹åºçš„ä¸€å¥—è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥åœ¨ WXML ä¸­ä½¿ç”¨ã€‚
- ç”¨äºè§†å›¾å±‚çš„æ•°æ®å¤„ç†
- æé«˜æ¸²æŸ“æ€§èƒ½ï¼ˆä¸éœ€è¦å’Œé€»è¾‘å±‚é€šä¿¡ï¼‰
- è¯­æ³•ç±»ä¼¼ JavaScript

```xml
<wxs module="m1">
  var msg = "hello world"
  function toLower(str) {
    return str.toLowerCase()
  }
  module.exports.toLower = toLower
</wxs>

<view>{{m1.toLower("HELLO")}}</view>
```

### ç½‘ç»œè¯·æ±‚

**15. å°ç¨‹åºå¦‚ä½•å¤„ç†è·¨åŸŸé—®é¢˜ï¼Ÿ**

ç­”ï¼šå°ç¨‹åºä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œä½†éœ€è¦ï¼š
- åœ¨å°ç¨‹åºç®¡ç†åå°é…ç½®æœåŠ¡å™¨åŸŸå
- æœåŠ¡å™¨åŸŸåå¿…é¡»æ˜¯ https
- ä¸€ä¸ªæœˆæœ€å¤šä¿®æ”¹ 5 æ¬¡æœåŠ¡å™¨åŸŸå

**16. å¦‚ä½•å®ç°è¯·æ±‚æ‹¦æˆªå’Œå“åº”æ‹¦æˆªï¼Ÿ**

ç­”ï¼šå°è£… wx.request
```javascript
// request.js
const request = (options) => {
  return new Promise((resolve, reject) => {
    // è¯·æ±‚æ‹¦æˆª
    const token = wx.getStorage
Sync('token')
    
    wx.request({
      ...options,
      header: {
        ...options.header,
        'Authorization': token
      },
      success(res) {
        // å“åº”æ‹¦æˆª
        if (res.statusCode === 200) {
          resolve(res.data)
        } else if (res.statusCode === 401) {
          wx.navigateTo({ url: '/pages/login/login' })
          reject(res)
        } else {
          reject(res)
        }
      },
      fail: reject
    })
  })
}

// ä½¿ç”¨
request({
  url: 'https://api.example.com/data',
  method: 'GET'
}).then(data => {
  console.log(data)
})
```

### ç¼“å­˜å­˜å‚¨

**17. localStorage å’Œ Storage çš„åŒºåˆ«ï¼Ÿ**

ç­”ï¼š
- å°ç¨‹åºä½¿ç”¨ wx.setStorage/wx.getStorageï¼Œä¸æ˜¯ localStorage
- å•ä¸ª key æœ€å¤§ 1MBï¼Œæ€»å¤§å°é™åˆ¶ 10MB
- åŒæ­¥æ–¹æ³•ï¼šwx.setStorageSync/getStorageSync
- å¼‚æ­¥æ–¹æ³•ï¼šwx.setStorage/getStorage

**18. å¦‚ä½•å®ç°æ•°æ®æŒä¹…åŒ–ï¼Ÿ**

ç­”ï¼š
```javascript
// æ–¹æ¡ˆ1ï¼šæœ¬åœ°å­˜å‚¨
wx.setStorageSync('userInfo', userInfo)

// æ–¹æ¡ˆ2ï¼šäº‘å¼€å‘æ•°æ®åº“ï¼ˆæŒä¹…åŒ–åˆ°äº‘ç«¯ï¼‰
const db = wx.cloud.database()
db.collection('users').add({
  data: { name: 'test' }
})

// æ–¹æ¡ˆ3ï¼šæ–‡ä»¶ç³»ç»Ÿ
const fs = wx.getFileSystemManager()
fs.writeFileSync(
  `${wx.env.USER_DATA_PATH}/data.txt`,
  'content'
)
```

### æ”¯ä»˜ç›¸å…³

**19. å°ç¨‹åºæ”¯ä»˜æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ**

ç­”ï¼š
1. å°ç¨‹åºè°ƒç”¨ wx.login() è·å– code
2. åç«¯ç”¨ code æ¢å– openid
3. åç«¯ç»Ÿä¸€ä¸‹å•ï¼ˆè°ƒç”¨å¾®ä¿¡æ”¯ä»˜APIï¼‰ï¼Œè·å–é¢„æ”¯ä»˜ prepay_id
4. åç«¯è¿”å›æ”¯ä»˜å‚æ•°ç»™å°ç¨‹åº
5. å°ç¨‹åºè°ƒç”¨ wx.requestPayment() å‘èµ·æ”¯ä»˜
6. ç”¨æˆ·å®Œæˆæ”¯ä»˜
7. å¾®ä¿¡å›è°ƒåç«¯æ”¯ä»˜ç»“æœ
8. åç«¯å¤„ç†ä¸šåŠ¡é€»è¾‘

```javascript
// å‰ç«¯å‘èµ·æ”¯ä»˜
wx.requestPayment({
  timeStamp: '',
  nonceStr: '',
  package: '',
  signType: 'MD5',
  paySign: '',
  success(res) {
    console.log('æ”¯ä»˜æˆåŠŸ')
  },
  fail(res) {
    console.log('æ”¯ä»˜å¤±è´¥')
  }
})
```

### äº‘å¼€å‘

**20. å°ç¨‹åºäº‘å¼€å‘æœ‰å“ªäº›èƒ½åŠ›ï¼Ÿ**

ç­”ï¼š
- äº‘å‡½æ•°ï¼šNode.js æœåŠ¡ç«¯ä»£ç 
- äº‘æ•°æ®åº“ï¼šJSON æ•°æ®åº“
- äº‘å­˜å‚¨ï¼šæ–‡ä»¶å­˜å‚¨
- äº‘è°ƒç”¨ï¼šè°ƒç”¨å¾®ä¿¡å¼€æ”¾æ¥å£

```javascript
// åˆå§‹åŒ–äº‘å¼€å‘
wx.cloud.init({
  env: 'my-env-id'
})

// äº‘å‡½æ•°è°ƒç”¨
wx.cloud.callFunction({
  name: 'login',
  data: { a: 1 },
  success: res => {
    console.log(res.result)
  }
})

// äº‘æ•°æ®åº“æ“ä½œ
const db = wx.cloud.database()
db.collection('users').get({
  success: res => {
    console.log(res.data)
  }
})

// äº‘å­˜å‚¨ä¸Šä¼ 
wx.cloud.uploadFile({
  cloudPath: 'example.png',
  filePath: '', // æœ¬åœ°æ–‡ä»¶è·¯å¾„
  success: res => {
    console.log(res.fileID)
  }
})
```

### å…¶ä»–å¸¸è§é—®é¢˜

**21. å¦‚ä½•å®ç°å°ç¨‹åºåˆ†äº«åŠŸèƒ½ï¼Ÿ**

ç­”ï¼š
```javascript
Page({
  onShareAppMessage() {
    return {
      title: 'åˆ†äº«æ ‡é¢˜',
      path: '/pages/index/index?id=123',
      imageUrl: '/images/share.jpg'
    }
  },
  // åˆ†äº«åˆ°æœ‹å‹åœˆï¼ˆéœ€è¦åœ¨ app.json ä¸­é…ç½®ï¼‰
  onShareTimeline() {
    return {
      title: 'åˆ†äº«åˆ°æœ‹å‹åœˆçš„æ ‡é¢˜',
      query: 'id=123'
    }
  }
})
```

**22. å°ç¨‹åºå¦‚ä½•å®ç°å›¾ç‰‡é¢„åŠ è½½ï¼Ÿ**

ç­”ï¼š
```javascript
// æ–¹æ³•1ï¼šä½¿ç”¨ wx.getImageInfo
wx.getImageInfo({
  src: 'https://example.com/image.jpg',
  success(res) {
    console.log('å›¾ç‰‡å·²åŠ è½½', res)
  }
})

// æ–¹æ³•2ï¼šä½¿ç”¨ Image å¯¹è±¡
const img = wx.createImage()
img.onload = () => {
  console.log('å›¾ç‰‡åŠ è½½å®Œæˆ')
}
img.src = 'https://example.com/image.jpg'

// æ–¹æ³•3ï¼šé¢„åŠ è½½å¤šå¼ å›¾ç‰‡
const preloadImages = (urls) => {
  return Promise.all(
    urls.map(url => {
      return new Promise((resolve) => {
        wx.getImageInfo({
          src: url,
          success: resolve,
          fail: resolve
        })
      })
    })
  )
}
```

**23. å¦‚ä½•å¤„ç†å°ç¨‹åºçš„å…¼å®¹æ€§é—®é¢˜ï¼Ÿ**

ç­”ï¼š
```javascript
// ç‰ˆæœ¬å…¼å®¹
if (wx.canIUse('getSystemInfoSync')) {
  const systemInfo = wx.getSystemInfoSync()
}

// API å…¼å®¹
if (wx.openBluetoothAdapter) {
  wx.openBluetoothAdapter()
} else {
  wx.showModal({
    title: 'æç¤º',
    content: 'å½“å‰å¾®ä¿¡ç‰ˆæœ¬è¿‡ä½ï¼Œè¯·å‡çº§'
  })
}

// æ¡ä»¶ç¼–è¯‘ï¼ˆä½¿ç”¨åŸºç¡€åº“ç‰ˆæœ¬ï¼‰
const version = wx.getSystemInfoSync().SDKVersion
if (compareVersion(version, '2.0.0') >= 0) {
  // é«˜ç‰ˆæœ¬ç‰¹æ€§
}
```

**24. å°ç¨‹åºçš„äº‹ä»¶å†’æ³¡å¦‚ä½•é˜»æ­¢ï¼Ÿ**

ç­”ï¼š
```xml
<!-- bind äº‹ä»¶ç»‘å®šä¸ä¼šé˜»æ­¢å†’æ³¡ -->
<view bindtap="outer">
  <view bindtap="inner">ç‚¹å‡»</view>
</view>

<!-- catch äº‹ä»¶ç»‘å®šä¼šé˜»æ­¢å†’æ³¡ -->
<view bindtap="outer">
  <view catchtap="inner">ç‚¹å‡»</view>
</view>

<!-- mut-bind äº’æ–¥äº‹ä»¶ç»‘å®š -->
<view mut-bind:tap="outer">
  <view mut-bind:tap="inner">ç‚¹å‡»</view>
</view>
```

**25. å°ç¨‹åºå¦‚ä½•å®ç°é•¿åˆ—è¡¨ä¼˜åŒ–ï¼Ÿ**

ç­”ï¼š
```javascript
// ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨ï¼ˆrecycle-viewï¼‰
// æˆ–åˆ†é¡µåŠ è½½
Page({
  data: {
    list: [],
    page: 1,
    hasMore: true
  },
  onReachBottom() {
    if (!this.data.hasMore) return
    
    this.loadMore()
  },
  loadMore() {
    wx.request({
      url: '/api/list',
      data: { page: this.data.page },
      success: (res) => {
        this.setData({
          list: [...this.data.list, ...res.data.list],
          page: this.data.page + 1,
          hasMore: res.data.hasMore
        })
      }
    })
  }
})
```

**26. å¦‚ä½•å®ç°å°ç¨‹åºçš„åŸ‹ç‚¹ç»Ÿè®¡ï¼Ÿ**

ç­”ï¼š
```javascript
// æ–¹æ³•1ï¼šé¡µé¢è®¿é—®ç»Ÿè®¡
Page({
  onShow() {
    this.trackPageView()
  },
  trackPageView() {
    wx.request({
      url: 'https://api.example.com/track',
      data: {
        event: 'page_view',
        page: this.route,
        timestamp: Date.now()
      }
    })
  }
})

// æ–¹æ³•2ï¼šäº‹ä»¶ç»Ÿè®¡
const trackEvent = (eventName, params) => {
  wx.request({
    url: 'https://api.example.com/track',
    data: {
      event: eventName,
      params,
      timestamp: Date.now()
    }
  })
}

// ä½¿ç”¨
trackEvent('button_click', { button: 'submit' })
```

**27. å°ç¨‹åºå¦‚ä½•å®ç°ä¸‹æ‹‰åŠ è½½æ›´å¤šï¼Ÿ**

ç­”ï¼š
```javascript
Page({
  data: {
    list: [],
    page: 1,
    loading: false
  },
  onLoad() {
    this.loadData()
  },
  onReachBottom() {
    if (this.data.loading) return
    this.loadData()
  },
  loadData() {
    this.setData({ loading: true })
    
    wx.request({
      url: '/api/list',
      data: { page: this.data.page },
      success: (res) => {
        this.setData({
          list: [...this.data.list, ...res.data.list],
          page: this.data.page + 1,
          loading: false
        })
      }
    })
  }
})
```

**28. å¦‚ä½•å®ç°å°ç¨‹åºçš„å…¨å±€çŠ¶æ€ç®¡ç†ï¼Ÿ**

ç­”ï¼š
```javascript
// æ–¹æ³•1ï¼šå…¨å±€å¯¹è±¡
// app.js
App({
  globalData: {
    userInfo: null,
    token: ''
  }
})

// é¡µé¢ä¸­ä½¿ç”¨
const app = getApp()
console.log(app.globalData.userInfo)

// æ–¹æ³•2ï¼šäº‹ä»¶æ€»çº¿
// event-bus.js
class EventBus {
  constructor() {
    this.events = {}
  }
  on(event, callback) {
    if (!this.events[event]) {
      this.events[event] = []
    }
    this.events[event].push(callback)
  }
  emit(event, data) {
    if (this.events[event]) {
      this.events[event].forEach(callback => callback(data))
    }
  }
  off(event, callback) {
    if (this.events[event]) {
      this.events[event] = this.events[event].filter(cb => cb !== callback)
    }
  }
}

export default new EventBus()

// ä½¿ç”¨
import eventBus from './event-bus'

// è®¢é˜…
eventBus.on('userLogin', (user) => {
  console.log('ç”¨æˆ·ç™»å½•', user)
})

// å‘å¸ƒ
eventBus.emit('userLogin', { name: 'test' })
```

**29. å°ç¨‹åºå¦‚ä½•å®ç°åŠ¨ç”»æ•ˆæœï¼Ÿ**

ç­”ï¼š
```javascript
// æ–¹æ³•1ï¼šä½¿ç”¨ wx.createAnimation
Page({
  data: {
    animationData: {}
  },
  onLoad() {
    this.animation = wx.createAnimation({
      duration: 1000,
      timingFunction: 'ease'
    })
  },
  startAnimation() {
    this.animation.scale(2).rotate(180).step()
    this.setData({
      animationData: this.animation.export()
    })
  }
})

// WXML
<view animation="{{animationData}}">åŠ¨ç”»å…ƒç´ </view>

// æ–¹æ³•2ï¼šä½¿ç”¨ CSS transition
// WXSS
.box {
  transition: all 0.3s;
  transform: scale(1);
}
.box-active {
  transform: scale(1.5);
}
```

**30. å¦‚ä½•è°ƒè¯•å°ç¨‹åºï¼Ÿ**

ç­”ï¼š
- ä½¿ç”¨å¼€å‘è€…å·¥å…·çš„è°ƒè¯•å™¨
- console.log æ‰“å°æ—¥å¿—
- çœŸæœºè°ƒè¯•ï¼ˆå¼€å¯è°ƒè¯•æ¨¡å¼ï¼‰
- vconsole æ’ä»¶
- æŠ“åŒ…å·¥å…·ï¼ˆCharlesã€Fiddlerï¼‰
- æ€§èƒ½åˆ†æå·¥å…·ï¼ˆAuditsï¼‰

```javascript
// æ¡ä»¶ç¼–è¯‘ï¼Œåªåœ¨å¼€å‘ç¯å¢ƒæ‰“å°
const isDev = wx.getAccountInfoSync().miniProgram.envVersion === 'develop'
if (isDev) {
  console.log('debug info')
}
```

---

## è¡¥å……ï¼šæ›´å¤šå®ç”¨API

### æ–‡ä»¶ç³»ç»Ÿ

```javascript
// è·å–æ–‡ä»¶ç³»ç»Ÿç®¡ç†å™¨
const fs = wx.getFileSystemManager()

// å†™å…¥æ–‡ä»¶
fs.writeFile({
  filePath: `${wx.env.USER_DATA_PATH}/hello.txt`,
  data: 'hello world',
  encoding: 'utf8',
  success() {
    console.log('å†™å…¥æˆåŠŸ')
  }
})

// è¯»å–æ–‡ä»¶
fs.readFile({
  filePath: `${wx.env.USER_DATA_PATH}/hello.txt`,
  encoding: 'utf8',
  success(res) {
    console.log(res.data)
  }
})

// åˆ é™¤æ–‡ä»¶
fs.unlink({
  filePath: `${wx.env.USER_DATA_PATH}/hello.txt`
})
```

### å‰ªè´´æ¿

```javascript
// è®¾ç½®å‰ªè´´æ¿å†…å®¹
wx.setClipboardData({
  data: 'è¦å¤åˆ¶çš„å†…å®¹',
  success() {
    wx.showToast({ title: 'å¤åˆ¶æˆåŠŸ' })
  }
})

// è·å–å‰ªè´´æ¿å†…å®¹
wx.getClipboardData({
  success(res) {
    console.log(res.data)
  }
})
```

### æ‰«ç 

```javascript
wx.scanCode({
  success(res) {
    console.log('æ‰«ç ç»“æœ', res.result)
    console.log('æ‰«ç ç±»å‹', res.scanType)
    console.log('å­—ç¬¦é›†', res.charSet)
  }
})
```

### æŒ¯åŠ¨

```javascript
// çŸ­æŒ¯åŠ¨
wx.vibrateShort({
  type: 'heavy'
})

// é•¿æŒ¯åŠ¨
wx.vibrateLong()
```

### å±å¹•äº®åº¦

```javascript
// è®¾ç½®å±å¹•äº®åº¦
wx.setScreenBrightness({
  value: 0.5  // 0-1
})

// è·å–å±å¹•äº®åº¦
wx.getScreenBrightness({
  success(res) {
    console.log(res.value)
  }
})

// è®¾ç½®ä¿æŒå¸¸äº®
wx.setKeepScreenOn({
  keepScreenOn: true
})
```

### è“ç‰™

```javascript
// åˆå§‹åŒ–è“ç‰™æ¨¡å—
wx.openBluetoothAdapter({
  success() {
    console.log('è“ç‰™åˆå§‹åŒ–æˆåŠŸ')
    // å¼€å§‹æœç´¢è“ç‰™è®¾å¤‡
    wx.startBluetoothDevicesDiscovery({
      success() {
        console.log('å¼€å§‹æœç´¢')
      }
    })
  }
})

// ç›‘å¬å¯»æ‰¾åˆ°æ–°è®¾å¤‡
wx.onBluetoothDeviceFound((res) => {
  console.log('å‘ç°æ–°è®¾å¤‡', res.devices)
})
```

### WebSocket

```javascript
// åˆ›å»º WebSocket è¿æ¥
const socketTask = wx.connectSocket({
  url: 'wss://example.com/socket'
})

// ç›‘å¬è¿æ¥æ‰“å¼€
socketTask.onOpen(() => {
  console.log('WebSocket è¿æ¥å·²æ‰“å¼€')
  
  // å‘é€æ•°æ®
  socketTask.send({
    data: 'Hello Server'
  })
})

// ç›‘å¬æ¥æ”¶æ¶ˆæ¯
socketTask.onMessage((res) => {
  console.log('æ”¶åˆ°æ¶ˆæ¯', res.data)
})

// ç›‘å¬è¿æ¥å…³é—­
socketTask.onClose(() => {
  console.log('WebSocket å·²å…³é—­')
})

// å…³é—­è¿æ¥
socketTask.close()
```

### èƒŒæ™¯éŸ³é¢‘

```javascript
// è·å–å…¨å±€å”¯ä¸€çš„èƒŒæ™¯éŸ³é¢‘ç®¡ç†å™¨
const bgAudioManager = wx.getBackgroundAudioManager()

// è®¾ç½®éŸ³é¢‘
bgAudioManager.title = 'éŸ³é¢‘æ ‡é¢˜'
bgAudioManager.epname = 'ä¸“è¾‘å'
bgAudioManager.singer = 'æ­Œæ‰‹å'
bgAudioManager.coverImgUrl = 'http://example.com/cover.jpg'
bgAudioManager.src = 'http://example.com/audio.mp3'

// æ’­æ”¾
bgAudioManager.play()

// æš‚åœ
bgAudioManager.pause()

// ç›‘å¬æ’­æ”¾
bgAudioManager.onPlay(() => {
  console.log('å¼€å§‹æ’­æ”¾')
})

// ç›‘å¬æš‚åœ
bgAudioManager.onPause(() => {
  console.log('å·²æš‚åœ')
})

// ç›‘å¬ç»“æŸ
bgAudioManager.onEnded(() => {
  console.log('æ’­æ”¾ç»“æŸ')
})
```

### ç”»å¸ƒ Canvas

```javascript
Page({
  onReady() {
    const query = wx.createSelectorQuery()
    query.select('#myCanvas')
      .fields({ node: true, size: true })
      .exec((res) => {
        const canvas = res[0].node
        const ctx = canvas.getContext('2d')
        
        const dpr = wx.getSystemInfoSync().pixelRatio
        canvas.width = res[0].width * dpr
        canvas.height = res[0].height * dpr
        ctx.scale(dpr, dpr)
        
        // ç»˜åˆ¶çŸ©å½¢
        ctx.fillStyle = 'red'
        ctx.fillRect(10, 10, 150, 100)
        
        // ç»˜åˆ¶æ–‡å­—
        ctx.fillStyle = 'black'
        ctx.font = '20px Arial'
        ctx.fillText('Hello Canvas', 20, 50)
        
        // ç»˜åˆ¶å›¾ç‰‡
        const img = canvas.createImage()
        img.onload = () => {
          ctx.drawImage(img, 0, 0, 100, 100)
        }
        img.src = '/images/logo.png'
      })
  }
})
```

---

## é«˜çº§é¢è¯•é¢˜

**31. å°ç¨‹åºçš„åŸç†æ¶æ„æ˜¯æ€æ ·çš„ï¼Ÿ**

ç­”ï¼šå°ç¨‹åºé‡‡ç”¨åŒçº¿ç¨‹æ¶æ„ï¼š
- æ¸²æŸ“å±‚ï¼ˆWebviewï¼‰ï¼šè´Ÿè´£é¡µé¢æ¸²æŸ“
- é€»è¾‘å±‚ï¼ˆJSCoreï¼‰ï¼šè´Ÿè´£é€»è¾‘å¤„ç†ã€æ•°æ®è¯·æ±‚ã€APIè°ƒç”¨
- Nativeï¼šè´Ÿè´£ä¸­è½¬é€šä¿¡ã€æä¾›åŸç”Ÿèƒ½åŠ›

ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡å¾®ä¿¡å®¢æˆ·ç«¯ï¼ˆNativeï¼‰åšä¸­è½¬ï¼ŒsetData æ•°æ®ä»é€»è¾‘å±‚ä¼ é€’åˆ°æ¸²æŸ“å±‚ï¼Œäº‹ä»¶ä»æ¸²æŸ“å±‚ä¼ é€’åˆ°é€»è¾‘å±‚ã€‚

**32. å°ç¨‹åºçš„æ¸²æŸ“æ€§èƒ½å¦‚ä½•ä¼˜åŒ–ï¼Ÿ**

ç­”ï¼š
- é¿å…é¢‘ç¹ setData
- å‡å°‘ setData çš„æ•°æ®é‡
- é¡µé¢åˆå§‹æ¸²æŸ“ä½¿ç”¨éª¨æ¶å±
- é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨
- å›¾ç‰‡æ‡’åŠ è½½
- åˆ†åŒ…åŠ è½½
- ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶
- åˆç†ä½¿ç”¨ wx:if å’Œ hidden
- é¿å…ä¸å½“çš„äº‹ä»¶ç»‘å®š

**33. å°ç¨‹åºå’Œ H5 çš„åŒºåˆ«ï¼Ÿ**

ç­”ï¼š
- è¿è¡Œç¯å¢ƒä¸åŒï¼šå°ç¨‹åºè¿è¡Œåœ¨å¾®ä¿¡ç¯å¢ƒï¼ŒH5 è¿è¡Œåœ¨æµè§ˆå™¨
- å¼€å‘æˆæœ¬ï¼šå°ç¨‹åºå¼€å‘ç®€å•ï¼ŒH5 éœ€è¦è€ƒè™‘æµè§ˆå™¨å…¼å®¹
- è·å–ç³»ç»Ÿæƒé™ï¼šå°ç¨‹åºå®¹æ˜“è·å–ï¼ŒH5 å—é™
- æ€§èƒ½ï¼šå°ç¨‹åºåŸºäºåŸç”Ÿæ¸²æŸ“ï¼Œæ€§èƒ½æ›´å¥½
- ä½“éªŒï¼šå°ç¨‹åºä½“éªŒæ¥è¿‘åŸç”ŸAPP

**34. å¦‚ä½•å®ç°å°ç¨‹åºçš„åŸ‹ç‚¹ç›‘æ§ç³»ç»Ÿï¼Ÿ**

ç­”ï¼š
```javascript
// åˆ›å»ºç›‘æ§ç±»
class Monitor {
  constructor() {
    this.queue = []
    this.timer = null
  }
  
  // æ·»åŠ åŸ‹ç‚¹
  track(event, data) {
    this.queue.push({
      event,
      data,
      timestamp: Date.now(),
      page: getCurrentPages().pop().route
    })
    
    // æ‰¹é‡ä¸ŠæŠ¥
    this.batchReport()
  }
  
  // æ‰¹é‡ä¸ŠæŠ¥
  batchReport() {
    clearTimeout(this.timer)
    this.timer = setTimeout(() => {
      if (this.queue.length === 0) return
      
      wx.request({
        url: 'https://api.example.com/track',
        method: 'POST',
        data: {
          events: this.queue
        },
        success: () => {
          this.queue = []
        }
      })
    }, 3000)
  }
  
  // é¡µé¢æ€§èƒ½ç›‘æ§
  pagePerformance(page) {
    const pages = getCurrentPages()
    const currentPage = pages[pages.length - 1]
    
    wx.reportPerformance(1001, {
      data: {
        page: currentPage.route,
        duration: Date.now() - page.startTime
      }
    })
  }
}

export default new Monitor()
```

**35. å°ç¨‹åºå¦‚ä½•å®ç°å¤šè¯­è¨€å›½é™…åŒ–ï¼Ÿ**

ç­”ï¼š
```javascript
// i18n.js
const messages = {
  'zh-CN': {
    home: 'é¦–é¡µ',
    user: 'ç”¨æˆ·'
  },
  'en-US': {
    home: 'Home',
    user: 'User'
  }
}

class I18n {
  constructor() {
    this.locale = wx.getSystemInfoSync().language || 'zh-CN'
  }
  
  t(key) {
    return messages[this.locale][key] || key
  }
  
  setLocale(locale) {
    this.locale = locale
  }
}

export default new I18n()

// ä½¿ç”¨
import i18n from './i18n'
Page({
  data: {
    homeText: i18n.t('home')
  }
})
```

---

## æ€»ç»“

æœ¬æ–‡æ¡£æ¶µç›–äº†å¾®ä¿¡å°ç¨‹åºå¼€å‘çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š

1. **æ¡†æ¶åŸºç¡€**ï¼šé¡¹ç›®ç»“æ„ã€ç”Ÿå‘½å‘¨æœŸã€æ•°æ®ç»‘å®š
2. **ç»„ä»¶ç³»ç»Ÿ**ï¼šè§†å›¾å®¹å™¨ã€åŸºç¡€å†…å®¹ã€è¡¨å•ç»„ä»¶ã€å¯¼èˆªã€åª’ä½“ç­‰
3. **API ç³»ç»Ÿ**ï¼šç½‘ç»œè¯·æ±‚ã€æ•°æ®ç¼“å­˜ã€ç•Œé¢äº¤äº’ã€è·¯ç”±ã€ä½ç½®ã€åª’ä½“ã€è®¾å¤‡ã€å¼€æ”¾æ¥å£ç­‰
4. **é¢è¯•é¢˜**ï¼šæ¶µç›–åŸºç¡€æ¦‚å¿µã€æ€§èƒ½ä¼˜åŒ–ã€æ•°æ®é€šä¿¡ã€ç™»å½•æˆæƒç­‰35+å¸¸è§é¢è¯•é¢˜

å»ºè®®å­¦ä¹ è·¯å¾„ï¼š
1. å…ˆæŒæ¡åŸºç¡€æ¡†æ¶å’Œç”Ÿå‘½å‘¨æœŸ
2. ç†Ÿæ‚‰å¸¸ç”¨ç»„ä»¶çš„ä½¿ç”¨
3. å­¦ä¹  API çš„è°ƒç”¨æ–¹å¼
4. å®æˆ˜é¡¹ç›®ç»ƒä¹ 
5. æ·±å…¥æ€§èƒ½ä¼˜åŒ–å’Œæ¶æ„è®¾è®¡

**å‚è€ƒèµ„æ–™**ï¼š
- [å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [å°ç¨‹åºç»„ä»¶åº“](https://developers.weixin.qq.com/miniprogram/dev/component/)
- [å°ç¨‹åº API](https://developers.weixin.qq.com/miniprogram/dev/api/)